<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üìä B·∫£ng K√™ T√≠nh L√£i</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    :root {
      --bg-gradient: linear-gradient(135deg, #0f172a, #1e293b);
      --card-bg: rgba(30, 41, 59, 0.8);
      --card-border: #334155;
      --text-primary: #f1f5f9;
      --text-secondary: #94a3b8;
      --accent: #60a5fa;
      --success: #22c55e;
    }

    [data-theme="light"] {
      --bg-gradient: linear-gradient(135deg, #e2e8f0, #cbd5e1);
      --card-bg: rgba(255, 255, 255, 0.9);
      --card-border: #cbd5e1;
      --text-primary: #1e293b;
      --text-secondary: #64748b;
      --accent: #2563eb;
      --success: #16a34a;
    }

    body {
      min-height: 100vh;
      background: var(--bg-gradient);
      color: var(--text-primary);
      transition: all 0.3s ease;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 50px;
    }

    .header h1 {
      font-size: 3rem;
      background: linear-gradient(135deg, #60a5fa, #a78bfa);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 15px;
    }

    .header p {
      font-size: 1.2rem;
      color: var(--text-secondary);
      max-width: 600px;
      margin: 0 auto;
    }

    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 1.2rem;
      backdrop-filter: blur(10px);
      z-index: 1000;
      transition: all 0.3s ease;
    }

    .theme-toggle:hover {
      transform: scale(1.1);
    }

    .bangke-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 25px;
      margin-bottom: 40px;
    }

    .bangke-card {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 20px;
      padding: 25px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .bangke-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
    }

    .bangke-card.active {
      border-color: var(--accent);
      box-shadow: 0 8px 32px rgba(96, 165, 250, 0.3);
    }

    .card-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
    }

    .card-icon {
      width: 60px;
      height: 60px;
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      flex-shrink: 0;
    }

    .card-info h3 {
      font-size: 1.3rem;
      margin-bottom: 5px;
    }

    .card-info .code {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    .card-description {
      color: var(--text-secondary);
      line-height: 1.5;
      margin-bottom: 15px;
    }

    .card-tags {
      display: flex;
      gap: 8px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .tag {
      background: rgba(96, 165, 250, 0.1);
      color: var(--accent);
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      border: 1px solid rgba(96, 165, 250, 0.3);
    }

    .card-actions {
      display: flex;
      gap: 10px;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 10px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
    }

    .btn-primary {
      background: linear-gradient(135deg, #3b82f6, #6366f1);
      color: white;
      box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.6);
    }

    .btn-secondary {
      background: transparent;
      color: var(--text-secondary);
      border: 1px solid var(--card-border);
    }

    .btn-secondary:hover {
      background: rgba(148, 163, 184, 0.1);
    }

    .card-details {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid var(--card-border);
      display: none;
    }

    .card-details.active {
      display: block;
    }

    .guide-section {
      background: rgba(15, 23, 42, 0.5);
      border-radius: 12px;
      padding: 20px;
      margin-top: 15px;
    }

    .guide-section h4 {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
      color: var(--accent);
    }

    .guide-list {
      list-style: none;
      padding: 0;
    }

    .guide-list li {
      padding: 8px 0;
      border-bottom: 1px solid rgba(148, 163, 184, 0.2);
      color: var(--text-secondary);
    }

    .guide-list li:last-child {
      border-bottom: none;
    }

    .guide-list li strong {
      color: var(--text-primary);
    }

    .admin-link {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 1.2rem;
      backdrop-filter: blur(10px);
      z-index: 1000;
      transition: all 0.3s ease;
      text-decoration: none;
      color: var(--text-primary);
    }

    .admin-link:hover {
      transform: scale(1.1);
    }

    .update-badge {
      background: var(--success);
      color: white;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 0.7rem;
      margin-left: 8px;
    }

    @media (max-width: 768px) {
      .header h1 {
        font-size: 2rem;
      }
      
      .bangke-grid {
        grid-template-columns: 1fr;
      }
      
      .card-actions {
        flex-direction: column;
      }
    }
  </style>
</head>
<body data-theme="dark">
  <button class="theme-toggle" onclick="toggleTheme()">üåô</button>
  
  <a href="admin.html" class="admin-link" title="Admin Panel">‚öôÔ∏è</a>

  <div class="container">
    <div class="header">
      <h1>üìä B·∫£ng K√™ T√≠nh L√£i</h1>
      <p>C√¥ng c·ª• qu·∫£n l√Ω v√† t√≠nh to√°n l√£i su·∫•t chuy√™n nghi·ªáp</p>
    </div>

    <div class="bangke-grid" id="bangkeGrid">
      <!-- N·ªôi dung s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
    </div>
  </div>

  <script>
    // D·ªØ li·ªáu m·∫´u - s·∫Ω ƒë∆∞·ª£c thay th·∫ø b·∫±ng BANG_KE_LIST t·ª´ admin
    const BANG_KE_LIST = [
      {
        id: 'ld',
        code: 'LD',
        name: 'B·∫£ng K√™ LD',
        short: 'T√≠nh l√£i LD',
        subtitle: 'B·∫£ng k√™ t√≠nh l√£i ti·ªÅn g·ª≠i c√≥ k·ª≥ h·∫°n chuy√™n nghi·ªáp',
        file: 'Bang_ke_LD.xlsm',
        updated: '10/11/2025',
        icon: 'üí∞',
        color: 'green',
        guide: [
          'Nh·∫≠p th√¥ng tin k·ª≥ h·∫°n v√† s·ªë ti·ªÅn g·ªëc v√†o c√°c √¥ m√†u xanh',
          'H·ªá th·ªëng t·ª± ƒë·ªông t√≠nh l√£i su·∫•t theo ng√†y th·ª±c t·∫ø',
          'Xem b√°o c√°o chi ti·∫øt v√† t·ªïng h·ª£p cu·ªëi k·ª≥',
          '<strong>L∆∞u √Ω:</strong> Kh√¥ng s·ª≠a c√°c √¥ c√¥ng th·ª©c m√†u v√†ng'
        ]
      },
      {
        id: 'the',
        code: 'TH',
        name: 'B·∫£ng K√™ Th·∫ª',
        short: 'Qu·∫£n l√Ω th·∫ª',
        subtitle: 'Theo d√µi chi ti√™u v√† t√≠nh l√£i th·∫ª t√≠n d·ª•ng',
        file: 'Bang_ke_The.xlsm',
        updated: '10/11/2025',
        icon: 'üí≥',
        color: 'blue',
        guide: [
          'Nh·∫≠p c√°c giao d·ªãch th·∫ª h√†ng ng√†y v√†o b·∫£ng chi ti·∫øt',
          'Theo d√µi h·∫°n m·ª©c v√† d∆∞ n·ª£ th·ª±c t·∫ø',
          'T·ª± ƒë·ªông t√≠nh l√£i v√† ph√≠ ph√°t sinh',
          'C·∫£nh b√°o khi g·∫ßn v∆∞·ª£t h·∫°n m·ª©c'
        ]
      }
    ];

    // M√†u s·∫Øc cho icon
    const colorSchemes = {
      green: 'linear-gradient(135deg, #22c55e, #16a34a)',
      blue: 'linear-gradient(135deg, #3b82f6, #2563eb)',
      purple: 'linear-gradient(135deg, #8b5cf6, #7c3aed)',
      orange: 'linear-gradient(135deg, #f59e0b, #d97706)'
    };

    function renderBangKe() {
      const grid = document.getElementById('bangkeGrid');
      grid.innerHTML = '';

      BANG_KE_LIST.forEach(item => {
        const card = document.createElement('div');
        card.className = 'bangke-card';
        card.innerHTML = `
          <div class="card-header">
            <div class="card-icon" style="background: ${colorSchemes[item.color]}">
              ${item.icon}
            </div>
            <div class="card-info">
              <h3>${item.name}</h3>
              <div class="code">${item.code} ‚Ä¢ Excel</div>
            </div>
          </div>
          
          <div class="card-description">
            ${item.subtitle}
          </div>
          
          <div class="card-tags">
            <div class="tag">${item.short}</div>
            ${item.updated ? `<div class="tag">C·∫≠p nh·∫≠t: ${item.updated}</div>` : ''}
          </div>
          
          <div class="card-actions">
            <a href="${item.file}" class="btn btn-primary" download>
              <span>üì•</span>
              <span>T·∫£i Xu·ªëng</span>
            </a>
            <button class="btn btn-secondary" onclick="toggleDetails(this)">
              <span>üìñ</span>
              <span>H∆∞·ªõng D·∫´n</span>
            </button>
          </div>
          
          <div class="card-details">
            <div class="guide-section">
              <h4>
                <span>üí°</span>
                <span>H∆∞·ªõng D·∫´n S·ª≠ D·ª•ng</span>
              </h4>
              <ul class="guide-list">
                ${item.guide.map(step => `<li>${step}</li>`).join('')}
              </ul>
            </div>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    function toggleDetails(button) {
      const card = button.closest('.bangke-card');
      const details = card.querySelector('.card-details');
      const isActive = details.classList.contains('active');
      
      // ƒê√≥ng t·∫•t c·∫£ c√°c card kh√°c
      document.querySelectorAll('.card-details').forEach(d => d.classList.remove('active'));
      document.querySelectorAll('.bangke-card').forEach(c => c.classList.remove('active'));
      
      if (!isActive) {
        details.classList.add('active');
        card.classList.add('active');
      }
    }

    function toggleTheme() {
      const currentTheme = document.body.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      document.body.setAttribute('data-theme', newTheme);
      
      const themeToggle = document.querySelector('.theme-toggle');
      themeToggle.textContent = newTheme === 'dark' ? 'üåô' : '‚òÄÔ∏è';
      
      localStorage.setItem('theme', newTheme);
    }

    // Kh·ªüi t·∫°o theme t·ª´ localStorage
    document.addEventListener('DOMContentLoaded', function() {
      const savedTheme = localStorage.getItem('theme') || 'dark';
      document.body.setAttribute('data-theme', savedTheme);
      
      const themeToggle = document.querySelector('.theme-toggle');
      themeToggle.textContent = savedTheme === 'dark' ? 'üåô' : '‚òÄÔ∏è';
      
      renderBangKe();
    });
  </script>
</body>
</html>
