<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üìä B·∫£ng K√™ T√≠nh L√£i</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    :root {
      --bg-gradient: linear-gradient(135deg, #0f172a, #1e293b);
      --card-bg: rgba(30, 41, 59, 0.9);
      --card-border: #334155;
      --text-primary: #f1f5f9;
      --text-secondary: #94a3b8;
      --accent: #60a5fa;
      --success: #22c55e;
      --donate: linear-gradient(135deg, #f97316, #ec4899);
    }

    [data-theme="light"] {
      --bg-gradient: linear-gradient(135deg, #e2e8f0, #cbd5e1);
      --card-bg: rgba(255, 255, 255, 0.95);
      --card-border: #cbd5e1;
      --text-primary: #1e293b;
      --text-secondary: #64748b;
      --accent: #2563eb;
      --success: #16a34a;
      --donate: linear-gradient(135deg, #f97316, #ec4899);
    }

    body {
      min-height: 100vh;
      background: var(--bg-gradient);
      color: var(--text-primary);
      transition: all 0.3s ease;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
      padding-top: 40px;
    }

    .header h1 {
      font-size: 3rem;
      background: linear-gradient(135deg, #60a5fa, #a78bfa);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
    }

    .header p {
      font-size: 1.2rem;
      color: var(--text-secondary);
      max-width: 600px;
      margin: 0 auto 30px;
    }

    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 1.2rem;
      backdrop-filter: blur(10px);
      z-index: 1000;
      transition: all 0.3s ease;
    }

    .theme-toggle:hover {
      transform: scale(1.1);
    }

    /* Donate Section */
    .donate-section {
      text-align: center;
      margin-bottom: 40px;
    }

    .donate-btn {
      background: var(--donate);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 50px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 8px 25px rgba(249, 115, 22, 0.4);
      transition: all 0.3s ease;
    }

    .donate-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 35px rgba(249, 115, 22, 0.6);
    }

    .donate-btn .icon {
      font-size: 1.3rem;
      animation: bounce 2s infinite;
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
      40% {transform: translateY(-5px);}
      60% {transform: translateY(-3px);}
    }

    /* Setup Guide */
    .setup-guide {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 20px;
      padding: 25px;
      margin-bottom: 40px;
      backdrop-filter: blur(10px);
    }

    .setup-header {
      display: flex;
      align-items: center;
      justify-content: between;
      cursor: pointer;
      margin-bottom: 15px;
    }

    .setup-title {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 1.3rem;
      font-weight: 600;
    }

    .setup-icon {
      width: 45px;
      height: 45px;
      border-radius: 12px;
      background: linear-gradient(135deg, #f97316, #ec4899);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
    }

    .setup-chevron {
      font-size: 1.5rem;
      color: var(--text-secondary);
      transition: transform 0.3s ease;
    }

    .setup-guide.active .setup-chevron {
      transform: rotate(180deg);
    }

    .setup-content {
      display: none;
      padding-top: 20px;
      border-top: 1px solid var(--card-border);
    }

    .setup-guide.active .setup-content {
      display: block;
    }

    .setup-steps {
      display: grid;
      gap: 20px;
    }

    .setup-step {
      display: flex;
      gap: 15px;
      align-items: flex-start;
    }

    .step-number {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      background: var(--accent);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      flex-shrink: 0;
      margin-top: 2px;
    }

    .step-content h4 {
      margin-bottom: 8px;
      color: var(--text-primary);
    }

    .step-content p {
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .setup-note {
      background: rgba(34, 197, 94, 0.1);
      border: 1px solid rgba(34, 197, 94, 0.3);
      border-radius: 12px;
      padding: 15px;
      margin-top: 20px;
      color: var(--success);
    }

    /* Bangke Grid */
    .bangke-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
      gap: 25px;
      margin-bottom: 40px;
    }

    .bangke-card {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 20px;
      padding: 25px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
    }

    .bangke-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
    }

    .bangke-card.active {
      border-color: var(--accent);
      box-shadow: 0 8px 32px rgba(96, 165, 250, 0.3);
    }

    .card-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
    }

    .card-icon {
      width: 70px;
      height: 70px;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      flex-shrink: 0;
    }

    .card-info h3 {
      font-size: 1.4rem;
      margin-bottom: 5px;
    }

    .card-info .code {
      color: var(--text-secondary);
      font-size: 0.95rem;
    }

    .card-description {
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 20px;
      font-size: 1rem;
    }

    .card-tags {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .tag {
      background: rgba(96, 165, 250, 0.1);
      color: var(--accent);
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 0.85rem;
      border: 1px solid rgba(96, 165, 250, 0.3);
    }

    .tag.update {
      background: rgba(34, 197, 94, 0.1);
      color: var(--success);
      border-color: rgba(34, 197, 94, 0.3);
    }

    .card-actions {
      display: flex;
      gap: 12px;
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
    }

    .btn-primary {
      background: linear-gradient(135deg, #3b82f6, #6366f1);
      color: white;
      box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.6);
    }

    .btn-secondary {
      background: transparent;
      color: var(--text-secondary);
      border: 1px solid var(--card-border);
    }

    .btn-secondary:hover {
      background: rgba(148, 163, 184, 0.1);
    }

    .card-details {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid var(--card-border);
      display: none;
    }

    .card-details.active {
      display: block;
    }

    .guide-section {
      background: rgba(15, 23, 42, 0.5);
      border-radius: 12px;
      padding: 20px;
      margin-top: 15px;
    }

    .guide-section h4 {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
      color: var(--accent);
      font-size: 1.1rem;
    }

    .guide-list {
      list-style: none;
      padding: 0;
    }

    .guide-list li {
      padding: 10px 0;
      border-bottom: 1px solid rgba(148, 163, 184, 0.2);
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .guide-list li:last-child {
      border-bottom: none;
    }

    .guide-list li strong {
      color: var(--text-primary);
    }

    /* Donate Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(5px);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: var(--card-bg);
      border-radius: 20px;
      padding: 30px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      border: 1px solid var(--card-border);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 20px;
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--text-secondary);
      cursor: pointer;
    }

    .modal h3 {
      color: #ec4899;
      margin-bottom: 10px;
    }

    .modal p {
      color: var(--text-secondary);
      margin-bottom: 20px;
    }

    .qr-code {
      background: white;
      padding: 15px;
      border-radius: 15px;
      margin-bottom: 15px;
    }

    .qr-code img {
      max-width: 100%;
      border-radius: 10px;
    }

    .modal-note {
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    /* Footer */
    .footer {
      text-align: center;
      padding: 30px 0;
      color: var(--text-secondary);
      border-top: 1px solid var(--card-border);
      margin-top: 40px;
    }

    @media (max-width: 768px) {
      .header h1 {
        font-size: 2.2rem;
      }
      
      .bangke-grid {
        grid-template-columns: 1fr;
      }
      
      .card-actions {
        flex-direction: column;
      }
      
      .container {
        padding: 15px;
      }
      
      .card-header {
        flex-direction: column;
        text-align: center;
        gap: 10px;
      }
      
      .card-icon {
        width: 60px;
        height: 60px;
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body data-theme="dark">
  <button class="theme-toggle" onclick="toggleTheme()">üåô</button>

  <div class="container">
    <!-- Header -->
    <div class="header">
      <h1>üìä B·∫£ng K√™ T√≠nh L√£i</h1>
      <p>C√¥ng c·ª• qu·∫£n l√Ω v√† t√≠nh to√°n l√£i su·∫•t chuy√™n nghi·ªáp</p>
      
      <!-- Donate Button -->
      <div class="donate-section">
        <button class="donate-btn" onclick="openDonateModal()">
          <span class="icon">üéÅ</span>
          <span>·ª¶ng h·ªô t√°c gi·∫£</span>
        </button>
      </div>
    </div>

    <!-- Setup Guide -->
    <div class="setup-guide" id="setupGuide">
      <div class="setup-header" onclick="toggleSetupGuide()">
        <div class="setup-title">
          <div class="setup-icon">‚öôÔ∏è</div>
          <span>C√†i ƒë·∫∑t m√°y tr∆∞·ªõc khi s·ª≠ d·ª•ng</span>
        </div>
        <div class="setup-chevron">‚ñæ</div>
      </div>
      <div class="setup-content" id="setupContent">
        <div class="setup-steps">
          <div class="setup-step">
            <div class="step-number">1</div>
            <div class="step-content">
              <h4>C√†i ƒë·∫∑t Microsoft Excel</h4>
              <p>ƒê·∫£m b·∫£o b·∫°n ƒë√£ c√†i ƒë·∫∑t Microsoft Excel 2016 tr·ªü l√™n ho·∫∑c ph·∫ßn m·ªÅm t∆∞∆°ng th√≠ch v·ªõi macro.</p>
            </div>
          </div>
          <div class="setup-step">
            <div class="step-number">2</div>
            <div class="step-content">
              <h4>B·∫≠t Macro trong Excel</h4>
              <p>V√†o File ‚Üí Options ‚Üí Trust Center ‚Üí Trust Center Settings ‚Üí Macro Settings ‚Üí Ch·ªçn "Enable all macros".</p>
            </div>
          </div>
          <div class="setup-step">
            <div class="step-number">3</div>
            <div class="step-content">
              <h4>ƒê·ªãnh d·∫°ng h·ªá th·ªëng</h4>
              <p>ƒê·∫£m b·∫£o m√°y t√≠nh s·ª≠ d·ª•ng ƒë·ªãnh d·∫°ng ng√†y DD/MM/YYYY v√† d·∫•u ph·∫©y ph·∫ßn ng√†n.</p>
            </div>
          </div>
        </div>
        <div class="setup-note">
          üí° <strong>L∆∞u √Ω:</strong> N·∫øu g·∫∑p l·ªói khi m·ªü file, h√£y ki·ªÉm tra l·∫°i c√°c b∆∞·ªõc tr√™n ho·∫∑c li√™n h·ªá h·ªó tr·ª£.
        </div>
      </div>
    </div>

    <!-- Bangke Grid -->
    <div class="bangke-grid" id="bangkeGrid">
      <!-- N·ªôi dung s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
    </div>

    <!-- Footer -->
    <div class="footer">
      <p>¬© 2024 B·∫£ng K√™ T√≠nh L√£i. ƒê∆∞·ª£c host tr√™n GitHub Pages.</p>
    </div>
  </div>

  <!-- Donate Modal -->
  <div class="modal" id="donateModal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeDonateModal()">‚úï</button>
      <h3>üéÅ ·ª¶ng h·ªô t√°c gi·∫£</h3>
      <p>N·∫øu b·∫°n th·∫•y b·ªô b·∫£ng k√™ h·ªØu √≠ch, c√≥ th·ªÉ ·ªßng h·ªô m√¨nh m·ªôt ly c√† ph√™.</p>
      <div class="qr-code">
        <img src="momo_qr.png" alt="QR Code MoMo" onerror="this.style.display='none'">
      </div>
      <p class="modal-note">Qu√©t b·∫±ng MoMo ho·∫∑c app ng√¢n h√†ng h·ªó tr·ª£ VietQR</p>
    </div>
  </div>

  <script>
    // ==================== D√ÅN ƒêO·∫†N CODE T·ª™ ADMIN V√ÄO ƒê√ÇY ====================
    const BANG_KE_LIST = [
      {
        id: 'ld',
        code: 'LD',
        name: 'B·∫£ng K√™ LD',
        short: 'T√≠nh l√£i LD',
        subtitle: 'B·∫£ng k√™ t√≠nh l√£i ti·ªÅn g·ª≠i c√≥ k·ª≥ h·∫°n chuy√™n nghi·ªáp',
        file: 'Bang_ke_LD.xlsm',
        updated: '10/11/2025',
        icon: 'üí∞',
        color: 'green',
        guide: [
          'Nh·∫≠p th√¥ng tin k·ª≥ h·∫°n v√† s·ªë ti·ªÅn g·ªëc v√†o c√°c √¥ m√†u xanh',
          'H·ªá th·ªëng t·ª± ƒë·ªông t√≠nh l√£i su·∫•t theo ng√†y th·ª±c t·∫ø',
          'Xem b√°o c√°o chi ti·∫øt v√† t·ªïng h·ª£p cu·ªëi k·ª≥',
          '<strong>L∆∞u √Ω:</strong> Kh√¥ng s·ª≠a c√°c √¥ c√¥ng th·ª©c m√†u v√†ng'
        ]
      },
      {
        id: 'the',
        code: 'TH',
        name: 'B·∫£ng K√™ Th·∫ª',
        short: 'Qu·∫£n l√Ω th·∫ª',
        subtitle: 'Theo d√µi chi ti√™u v√† t√≠nh l√£i th·∫ª t√≠n d·ª•ng',
        file: 'Bang_ke_The.xlsm',
        updated: '10/11/2025',
        icon: 'üí≥',
        color: 'blue',
        guide: [
          'Nh·∫≠p c√°c giao d·ªãch th·∫ª h√†ng ng√†y v√†o b·∫£ng chi ti·∫øt',
          'Theo d√µi h·∫°n m·ª©c v√† d∆∞ n·ª£ th·ª±c t·∫ø',
          'T·ª± ƒë·ªông t√≠nh l√£i v√† ph√≠ ph√°t sinh',
          'C·∫£nh b√°o khi g·∫ßn v∆∞·ª£t h·∫°n m·ª©c'
        ]
      }
    ];
    // ==================== K·∫æT TH√öC CODE T·ª™ ADMIN ====================

    // M√†u s·∫Øc cho icon
    const colorSchemes = {
      green: 'linear-gradient(135deg, #22c55e, #16a34a)',
      blue: 'linear-gradient(135deg, #3b82f6, #2563eb)',
      purple: 'linear-gradient(135deg, #8b5cf6, #7c3aed)',
      orange: 'linear-gradient(135deg, #f59e0b, #d97706)',
      pink: 'linear-gradient(135deg, #ec4899, #db2777)'
    };

    function renderBangKe() {
      const grid = document.getElementById('bangkeGrid');
      grid.innerHTML = '';

      BANG_KE_LIST.forEach(item => {
        const card = document.createElement('div');
        card.className = 'bangke-card';
        card.innerHTML = `
          <div class="card-header">
            <div class="card-icon" style="background: ${colorSchemes[item.color]}">
              ${item.icon}
            </div>
            <div class="card-info">
              <h3>${item.name}</h3>
              <div class="code">${item.code} ‚Ä¢ Excel Macro</div>
            </div>
          </div>
          
          <div class="card-description">
            ${item.subtitle}
          </div>
          
          <div class="card-tags">
            <div class="tag">${item.short}</div>
            ${item.updated ? `<div class="tag update">üïê ${item.updated}</div>` : ''}
          </div>
          
          <div class="card-actions">
            <a href="${item.file}" class="btn btn-primary" download>
              <span>üì•</span>
              <span>T·∫£i Xu·ªëng</span>
            </a>
            <button class="btn btn-secondary" onclick="toggleDetails(this)">
              <span>üìñ</span>
              <span>H∆∞·ªõng D·∫´n</span>
            </button>
          </div>
          
          <div class="card-details">
            <div class="guide-section">
              <h4>
                <span>üí°</span>
                <span>H∆∞·ªõng D·∫´n S·ª≠ D·ª•ng</span>
              </h4>
              <ul class="guide-list">
                ${item.guide.map(step => `<li>${step}</li>`).join('')}
              </ul>
            </div>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    function toggleDetails(button) {
      const card = button.closest('.bangke-card');
      const details = card.querySelector('.card-details');
      const isActive = details.classList.contains('active');
      
      // ƒê√≥ng t·∫•t c·∫£ c√°c card kh√°c
      document.querySelectorAll('.card-details').forEach(d => d.classList.remove('active'));
      document.querySelectorAll('.bangke-card').forEach(c => c.classList.remove('active'));
      
      if (!isActive) {
        details.classList.add('active');
        card.classList.add('active');
      }
    }

    function toggleSetupGuide() {
      const guide = document.getElementById('setupGuide');
      const content = document.getElementById('setupContent');
      guide.classList.toggle('active');
    }

    function toggleTheme() {
      const currentTheme = document.body.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      document.body.setAttribute('data-theme', newTheme);
      
      const themeToggle = document.querySelector('.theme-toggle');
      themeToggle.textContent = newTheme === 'dark' ? 'üåô' : '‚òÄÔ∏è';
      
      localStorage.setItem('theme', newTheme);
    }

    function openDonateModal() {
      document.getElementById('donateModal').classList.add('active');
    }

    function closeDonateModal() {
      document.getElementById('donateModal').classList.remove('active');
    }

    // ƒê√≥ng modal khi click b√™n ngo√†i
    document.getElementById('donateModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeDonateModal();
      }
    });

    // Kh·ªüi t·∫°o
    document.addEventListener('DOMContentLoaded', function() {
      const savedTheme = localStorage.getItem('theme') || 'dark';
      document.body.setAttribute('data-theme', savedTheme);
      
      const themeToggle = document.querySelector('.theme-toggle');
      themeToggle.textContent = savedTheme === 'dark' ? 'üåô' : '‚òÄÔ∏è';
      
      renderBangKe();
      
      // M·ªü h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t m·∫∑c ƒë·ªãnh
      document.getElementById('setupGuide').classList.add('active');
    });

    // X·ª≠ l√Ω l·ªói download file
    document.addEventListener('click', function(e) {
      if (e.target.closest('.btn-primary')) {
        const link = e.target.closest('.btn-primary');
        const file = link.getAttribute('href');
        
        fetch(file, { method: 'HEAD' })
          .then(response => {
            if (!response.ok) {
              alert('‚ùå File kh√¥ng t·ªìn t·∫°i. Vui l√≤ng ki·ªÉm tra l·∫°i t√™n file tr√™n GitHub.');
              e.preventDefault();
            }
          })
          .catch(() => {
            alert('‚ùå Kh√¥ng th·ªÉ t·∫£i file. Vui l√≤ng ki·ªÉm tra k·∫øt n·ªëi internet.');
            e.preventDefault();
          });
      }
    });
  </script>
</body>
</html>
