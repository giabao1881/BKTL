<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>B·∫£ng K√™ T√≠nh L√£i - Premium Edition</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    /* =========================================
       CORE VARIABLES & THEMES
       ========================================= */
    :root {
      --font-main: 'Outfit', sans-serif;
      --radius-sm: 12px;
      --radius-md: 20px;
      --radius-lg: 32px;
      --trans-speed: 0.4s;
      --ease-elastic: cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    body[data-theme="dark"] {
      --bg-color: #050505;
      --bg-gradient: radial-gradient(circle at 10% 20%, rgba(29, 78, 216, 0.15) 0%, transparent 40%),
                     radial-gradient(circle at 90% 80%, rgba(236, 72, 153, 0.1) 0%, transparent 40%);
      --glass-panel: rgba(20, 20, 23, 0.6);
      --glass-border: rgba(255, 255, 255, 0.08);
      --card-bg: rgba(30, 30, 35, 0.4);
      --card-hover: rgba(40, 40, 45, 0.6);
      --text-main: #ffffff;
      --text-muted: #9ca3af;
      --primary: #3b82f6;
      --accent: #f43f5e;
      --glow: 0 0 20px rgba(59, 130, 246, 0.3);
      --shadow: 0 20px 50px -12px rgba(0, 0, 0, 0.7);
      --btn-bg: rgba(255, 255, 255, 0.1);
      --chip-bg: rgba(255, 255, 255, 0.05);
    }

    body[data-theme="light"] {
      --bg-color: #f0f4f8;
      --bg-gradient: radial-gradient(circle at 0% 0%, #e0e7ff 0%, transparent 50%),
                     radial-gradient(circle at 100% 100%, #fce7f3 0%, transparent 50%);
      --glass-panel: rgba(255, 255, 255, 0.65);
      --glass-border: rgba(255, 255, 255, 0.6);
      --card-bg: rgba(255, 255, 255, 0.5);
      --card-hover: rgba(255, 255, 255, 0.85);
      --text-main: #1e293b;
      --text-muted: #64748b;
      --primary: #2563eb;
      --accent: #e11d48;
      --glow: 0 0 20px rgba(37, 99, 235, 0.15);
      --shadow: 0 20px 50px -12px rgba(100, 116, 139, 0.15);
      --btn-bg: #ffffff;
      --chip-bg: rgba(0, 0, 0, 0.04);
    }

    /* =========================================
       RESET & BASE STYLES
       ========================================= */
    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
    
    body {
      font-family: var(--font-main);
      background-color: var(--bg-color);
      background-image: var(--bg-gradient);
      background-attachment: fixed;
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 20px 16px;
      overflow-x: hidden;
      transition: background-color 0.5s ease, color 0.5s ease;
    }

    /* Ambient Background Blobs */
    .blob-cont {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; pointer-events: none;
    }
    .blob {
      position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.6;
      animation: floatBlob 20s infinite alternate;
    }
    .blob-1 { top: -10%; left: -10%; width: 50vw; height: 50vw; background: var(--primary); opacity: 0.2; }
    .blob-2 { bottom: -10%; right: -10%; width: 50vw; height: 50vw; background: var(--accent); opacity: 0.15; animation-delay: -10s; }

    @keyframes floatBlob { 0% { transform: translate(0, 0) scale(1); } 100% { transform: translate(50px, 50px) scale(1.1); } }

    /* =========================================
       MAIN LAYOUT (THE SHELL)
       ========================================= */
    .shell {
      width: 100%;
      max-width: 800px;
      position: relative;
      z-index: 1;
      animation: fadeInUp 0.8s var(--ease-elastic);
    }

    @keyframes fadeInUp { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }

    /* GLASS PANEL CONTAINER */
    .panel {
      background: var(--glass-panel);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-lg);
      padding: 32px;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }

    /* Top Decoration Line */
    .panel::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px;
      background: linear-gradient(90deg, #3b82f6, #ec4899, #8b5cf6);
      opacity: 0.8;
    }

    /* =========================================
       HEADER AREA
       ========================================= */
    .panel-header {
      display: flex; flex-direction: column; gap: 20px; margin-bottom: 30px;
      position: relative;
    }

    .top-bar {
      display: flex; justify-content: space-between; align-items: center;
    }

    .brand-badge {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 6px 12px; background: var(--chip-bg);
      border-radius: 50px; border: 1px solid var(--glass-border);
      font-size: 13px; font-weight: 600; color: var(--text-muted);
    }
    .pulse-dot {
      width: 8px; height: 8px; background: #22c55e; border-radius: 50%;
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.2);
      animation: pulse 2s infinite;
    }
    @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(34,197,94,0.4); } 70% { box-shadow: 0 0 0 8px rgba(34,197,94,0); } 100% { box-shadow: 0 0 0 0 rgba(34,197,94,0); } }

    .header-content h1 {
      font-size: 36px; font-weight: 800; letter-spacing: -1px; margin-bottom: 8px;
      background: linear-gradient(135deg, var(--text-main) 30%, var(--primary));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    .header-content .subtitle {
      font-size: 15px; color: var(--text-muted); line-height: 1.5; max-width: 600px;
    }

    /* Controls Row */
    .controls-row {
      display: flex; gap: 12px; align-items: center; flex-wrap: wrap; margin-top: 10px;
    }

    /* Theme Toggle Switch */
    .theme-toggle {
      background: var(--card-bg); border: 1px solid var(--glass-border);
      border-radius: 50px; padding: 4px; display: flex; align-items: center;
      cursor: pointer; position: relative; width: 100px; height: 40px;
      box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
      transition: all 0.3s ease;
    }
    .theme-pill {
      position: absolute; left: 4px; top: 4px; bottom: 4px; width: 44px;
      background: var(--primary); border-radius: 50px;
      transition: transform 0.4s var(--ease-elastic);
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      z-index: 1;
    }
    body[data-theme="light"] .theme-pill { transform: translateX(0); background: #ffffff; }
    body[data-theme="dark"] .theme-pill { transform: translateX(48px); background: #3b82f6; }
    
    .theme-icon {
      flex: 1; text-align: center; font-size: 16px; z-index: 2; line-height: 0;
      transition: transform 0.3s ease;
    }
    body[data-theme="light"] .theme-icon:first-child { transform: scale(1.2); }
    body[data-theme="dark"] .theme-icon:last-child { transform: scale(1.2); }

    /* Other Buttons */
    .btn-tools, .btn-donate {
      height: 40px; padding: 0 20px; border-radius: 50px;
      border: 1px solid var(--glass-border);
      background: var(--btn-bg); color: var(--text-main);
      font-size: 13px; font-weight: 600; text-decoration: none;
      display: inline-flex; align-items: center; gap: 8px;
      transition: all 0.3s ease; cursor: pointer;
    }
    .btn-tools:hover, .btn-donate:hover { transform: translateY(-2px); border-color: var(--primary); color: var(--primary); }
    
    .btn-donate { background: linear-gradient(135deg, #f59e0b15, #ec489915); border-color: rgba(236, 72, 153, 0.3); color: #ec4899; }
    .btn-donate:hover { background: linear-gradient(135deg, #f59e0b, #ec4899); color: white; border-color: transparent; box-shadow: 0 10px 20px rgba(236, 72, 153, 0.4); }

    /* =========================================
       SETUP GUIDE (ACCORDION STYLE)
       ========================================= */
    .setup-guide {
      background: rgba(15, 23, 42, 0.4); border: 1px solid var(--glass-border);
      border-radius: var(--radius-md); overflow: hidden; margin-bottom: 24px;
      transition: all 0.4s ease;
    }
    body[data-theme="light"] .setup-guide { background: rgba(255, 255, 255, 0.5); }
    
    .setup-header {
      padding: 16px 20px; display: flex; align-items: center; justify-content: space-between;
      cursor: pointer; background: transparent; transition: background 0.2s;
    }
    .setup-header:hover { background: rgba(125, 125, 125, 0.05); }
    
    .setup-title { display: flex; align-items: center; gap: 12px; font-weight: 700; color: var(--text-main); }
    .setup-icon-box {
      width: 32px; height: 32px; border-radius: 10px; background: linear-gradient(135deg, #f97316, #ea580c);
      display: flex; align-items: center; justify-content: center; color: white; font-size: 16px;
      box-shadow: 0 4px 12px rgba(249, 115, 22, 0.3);
    }
    .setup-chevron { transition: transform 0.4s ease; color: var(--text-muted); }
    .setup-guide.active .setup-chevron { transform: rotate(180deg); }

    .setup-content {
      display: none; padding: 0 20px 20px; animation: slideDown 0.4s ease;
    }
    .setup-guide.active .setup-content { display: block; }

    .step-card {
      background: var(--chip-bg); border-radius: 16px; padding: 16px; margin-top: 12px;
      border: 1px dashed var(--glass-border);
    }
    .step-row { display: flex; gap: 12px; margin-bottom: 12px; }
    .step-num {
      width: 24px; height: 24px; background: var(--primary); color: white;
      border-radius: 50%; font-size: 12px; font-weight: bold;
      display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px;
    }
    .step-text { font-size: 14px; line-height: 1.6; color: var(--text-main); }
    .step-text strong { color: var(--primary); }

    .setup-image {
      border-radius: 12px; overflow: hidden; margin-top: 8px; border: 1px solid var(--glass-border);
      cursor: zoom-in; transition: transform 0.3s ease; background: black;
    }
    .setup-image:hover { transform: scale(1.02); }
    .setup-image img { width: 100%; display: block; }
    .caption { font-size: 11px; text-align: center; padding: 6px; color: #9ca3af; background: rgba(0,0,0,0.8); }

    /* =========================================
       ITEM LIST (THE CARDS)
       ========================================= */
    .list { display: grid; gap: 16px; }

    .item {
      background: var(--card-bg); border: 1px solid var(--glass-border);
      border-radius: var(--radius-md); padding: 20px;
      transition: all 0.3s var(--ease-elastic);
      position: relative; overflow: hidden; cursor: default;
    }
    .item::after {
      content: ''; position: absolute; left: 0; top: 0; width: 4px; height: 100%;
      background: var(--item-color, var(--primary)); opacity: 0.8;
    }
    .item:hover {
      transform: translateY(-5px) scale(1.01);
      box-shadow: var(--shadow), var(--glow);
      border-color: rgba(255,255,255,0.2);
    }
    .item.active {
      background: linear-gradient(135deg, rgba(59,130,246,0.08), transparent);
      border-color: var(--primary);
    }

    .item-header { display: flex; align-items: center; gap: 16px; cursor: pointer; }

    .icon-box {
      width: 64px; height: 64px; border-radius: 18px;
      display: flex; align-items: center; justify-content: center; font-size: 28px;
      background: var(--bg-gradient-icon);
      color: white; box-shadow: 0 10px 20px rgba(0,0,0,0.2);
      flex-shrink: 0; position: relative; overflow: hidden;
    }
    .icon-box::before {
      content: ''; position: absolute; inset: 0; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3));
    }

    .info-box { flex: 1; }
    .info-title { font-size: 18px; font-weight: 700; margin-bottom: 6px; display: flex; justify-content: space-between; align-items: center; }
    .info-chevron { font-size: 20px; color: var(--text-muted); transition: 0.3s; }
    .item.active .info-chevron { transform: rotate(180deg); color: var(--primary); }

    .tags { display: flex; flex-wrap: wrap; gap: 6px; }
    .tag {
      font-size: 11px; padding: 4px 10px; border-radius: 20px;
      background: var(--chip-bg); border: 1px solid var(--glass-border);
      color: var(--text-muted); font-weight: 500;
    }
    .tag.update { background: rgba(34, 197, 94, 0.1); color: #22c55e; border-color: rgba(34, 197, 94, 0.2); }

    /* Expanded Content */
    .extra { display: none; margin-top: 20px; padding-top: 20px; border-top: 1px dashed var(--glass-border); animation: fadeIn 0.4s ease; }
    .extra.visible { display: block; }
    .extra-desc { font-size: 14px; color: var(--text-muted); margin-bottom: 16px; font-style: italic; }

    .action-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    
    .btn {
      height: 44px; border-radius: 12px; display: flex; align-items: center; justify-content: center; gap: 8px;
      font-size: 14px; font-weight: 600; cursor: pointer; border: none; transition: all 0.2s;
      text-decoration: none; position: relative; overflow: hidden;
    }
    .btn-primary {
      background: linear-gradient(90deg, #3b82f6, #2563eb); color: white;
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
    }
    .btn-primary:hover { box-shadow: 0 8px 20px rgba(37, 99, 235, 0.6); transform: translateY(-2px); }
    
    .btn-secondary {
      background: rgba(255,255,255,0.05); color: var(--text-main); border: 1px solid var(--glass-border);
    }
    .btn-secondary:hover { background: rgba(255,255,255,0.1); border-color: var(--text-muted); transform: translateY(-2px); }

    /* Guide Box inside Item */
    .inner-guide {
      margin-top: 16px; background: rgba(0,0,0,0.2); border-radius: 12px; padding: 16px;
      display: none; border: 1px solid var(--glass-border);
    }
    .inner-guide.visible { display: block; animation: slideDown 0.3s; }
    .guide-line { display: flex; gap: 10px; margin-bottom: 8px; font-size: 13px; color: var(--text-muted); }
    .guide-bullet { color: var(--primary); }
    .guide-line a { color: var(--accent); text-decoration: none; font-weight: 600; }

    /* =========================================
       MODALS & FOOTER
       ========================================= */
    .donate-modal {
      position: fixed; inset: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px);
      z-index: 100; display: none; align-items: center; justify-content: center;
      animation: fadeIn 0.3s;
    }
    .donate-modal.visible { display: flex; }
    .modal-card {
      background: #18181b; width: 90%; max-width: 380px; padding: 30px; border-radius: 30px;
      border: 1px solid rgba(255,255,255,0.1); text-align: center; position: relative;
      box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); transform: scale(0.9); animation: popIn 0.3s forwards;
    }
    @keyframes popIn { to { transform: scale(1); } }

    .modal-close { position: absolute; top: 15px; right: 15px; background: none; border: none; color: #fff; font-size: 20px; cursor: pointer; opacity: 0.5; }
    .modal-close:hover { opacity: 1; }
    
    .qr-frame {
      background: white; padding: 10px; border-radius: 20px; margin: 20px 0;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }
    .qr-frame img { width: 100%; display: block; border-radius: 10px; }
    .donate-h { color: #ec4899; font-size: 20px; font-weight: 800; margin-bottom: 5px; }

    footer { text-align: center; margin-top: 40px; font-size: 12px; color: var(--text-muted); opacity: 0.6; }

    /* Zoom Overlay */
    .zoom-overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 200;
      display: none; align-items: center; justify-content: center; cursor: zoom-out;
    }
    .zoom-overlay.active { display: flex; }
    .zoom-overlay img { max-width: 95vw; max-height: 95vh; border-radius: 8px; box-shadow: 0 0 50px rgba(0,0,0,0.5); animation: zoomIn 0.3s; }
    @keyframes zoomIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

    /* Responsive */
    @media (max-width: 600px) {
      .panel { padding: 20px 16px; }
      .header-content h1 { font-size: 26px; }
      .action-grid { grid-template-columns: 1fr; }
      .item-header { gap: 12px; }
      .icon-box { width: 50px; height: 50px; font-size: 22px; }
    }
  </style>
</head>

<body data-theme="dark">
  <div class="blob-cont">
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>
  </div>

  <main class="shell">
    <section class="panel">
      
      <header class="panel-header">
        <div class="top-bar">
          <div class="brand-badge">
            <span class="pulse-dot"></span>
            <span>B·∫¢NG K√ä 2026</span>
          </div>
          <a href="https://giabao1881.github.io/baotg10/" class="btn-tools" target="_blank">
            <span>üõ†Ô∏è C√¥ng c·ª• kh√°c</span>
          </a>
        </div>

        <div class="header-content">
          <h1>TRUNG T√ÇM T√çNH L√ÉI</h1>
          <p class="subtitle">H·ªá th·ªëng b·∫£ng k√™ t·ª± ƒë·ªông h√≥a. C·∫≠p nh·∫≠t li√™n t·ª•c. ƒê·ªô ch√≠nh x√°c cao.</p>
          
          <div class="controls-row">
            <button id="themeToggle" class="theme-toggle" aria-label="ƒê·ªïi giao di·ªán">
              <div class="theme-pill"></div>
              <div class="theme-icon">üåû</div>
              <div class="theme-icon">üåô</div>
            </button>
            
            <button id="donateBtn" class="btn-donate">
              <span>üéÅ Donate ·ªßng h·ªô</span>
            </button>
          </div>
        </div>
      </header>

      <div class="setup-guide" id="setupGuide">
        <div class="setup-header">
          <div class="setup-title">
            <div class="setup-icon-box">‚öôÔ∏è</div>
            <span>C·∫•u h√¨nh h·ªá th·ªëng tr∆∞·ªõc khi d√πng</span>
          </div>
          <div class="setup-chevron">‚ñº</div>
        </div>

        <div class="setup-content">
          <div style="padding-top: 10px; color: var(--text-muted); font-size: 13px;">
            Th·ª±c hi·ªán 1 l·∫ßn duy nh·∫•t ƒë·ªÉ Excel ho·∫°t ƒë·ªông chu·∫©n x√°c 100%.
          </div>

          <div class="step-card">
            <div style="font-weight: 700; color: var(--primary); margin-bottom: 10px;">1. C√†i ƒë·∫∑t Region (Control Panel)</div>
            
            <div class="step-row">
              <div class="step-num">1</div>
              <div class="step-text">Windows ‚Üí T√¨m <strong>Control Panel</strong> ‚Üí M·ªü l√™n.
                <div class="setup-image" onclick="zoomImg(this)"><img src="media/image1.jpeg" alt="Control Panel" onerror="this.style.display='none'"></div>
              </div>
            </div>

            <div class="step-row">
              <div class="step-num">2</div>
              <div class="step-text">Ch·ªçn <strong>Clock and Region</strong> ‚Üí <strong>Region</strong>.
                <div class="setup-image" onclick="zoomImg(this)"><img src="media/image2.jpeg" alt="Region" onerror="this.style.display='none'"></div>
              </div>
            </div>

            <div class="step-row">
              <div class="step-num">3</div>
              <div class="step-text">Tab Format: Ch·ªçn <strong>Vietnamese (Vietnam)</strong> ƒë·ªÉ chu·∫©n ng√†y gi·ªù (dd/mm/yyyy).
                <div class="setup-image" onclick="zoomImg(this)"><img src="media/image3.jpeg" alt="Format VN" onerror="this.style.display='none'"></div>
              </div>
            </div>
          </div>

          <div class="step-card">
            <div style="font-weight: 700; color: var(--accent); margin-bottom: 10px;">2. C√†i ƒë·∫∑t Excel (Quan tr·ªçng)</div>
            <div class="step-row">
              <div class="step-num">1</div>
              <div class="step-text">M·ªü Excel ‚Üí <strong>File ‚Üí Options ‚Üí Advanced</strong>.</div>
            </div>
            <div class="step-row">
              <div class="step-num">2</div>
              <div class="step-text">B·ªè ch·ªçn "Use system separators".<br>
                Decimal separator (D·∫•u th·∫≠p ph√¢n): ƒë·ªÉ l√† <strong>,</strong> (ph·∫©y)<br>
                Thousands separator (D·∫•u h√†ng ng√†n): ƒë·ªÉ l√† <strong>.</strong> (ch·∫•m)<br>
                <em>(Ho·∫∑c ng∆∞·ª£c l·∫°i t√πy nhu c·∫ßu, mi·ªÖn l√† ƒë·ªìng nh·∫•t)</em>
                <div class="setup-image" onclick="zoomImg(this)"><img src="media/image4.png" alt="Excel Setting" onerror="this.style.display='none'"></div>
              </div>
            </div>
          </div>

        </div>
      </div>

      <div class="list" id="list">
        </div>

      <footer>
        &copy; 2026 Designed by baotg10 <br> Premium Financial Tools
      </footer>
    </section>
  </main>

  <div id="donateModal" class="donate-modal">
    <div class="modal-card">
      <button id="donateClose" class="modal-close">‚úï</button>
      <div class="donate-h">C·∫£m ∆°n b·∫°n! ‚ù§Ô∏è</div>
      <p style="font-size: 13px; color: #d1d5db;">S·ª± ·ªßng h·ªô c·ªßa b·∫°n l√† ƒë·ªông l·ª±c ƒë·ªÉ m√¨nh duy tr√¨ v√† n√¢ng c·∫•p tool x·ªãn h∆°n m·ªói ng√†y.</p>
      
      <div class="qr-frame">
        <img src="momo_qr.png" alt="QR Code" onerror="this.src='https://via.placeholder.com/200x200?text=QR+Image+Missing'">
      </div>
      
      <div style="font-size: 12px; color: #9ca3af;">H·ªó tr·ª£ MoMo & C√°c ng√¢n h√†ng (VietQR)</div>
    </div>
  </div>

  <div id="zoomOverlay" class="zoom-overlay" onclick="closeZoom()">
    <img id="zoomTarget" src="" alt="Zoomed">
  </div>

  <script>
    /* =========================================
       DATA & LOGIC (GI·ªÆ NGUY√äN B·∫¢N G·ªêC)
       ========================================= */
    const BANG_KE_LIST = [
      {
        id: "ld", code: "LD", name: "BKTL LD PRO", short: "Super Tool",
        subtitle: "X·ª≠ l√Ω h√†ng lo·∫°t 10+ b·∫£ng LD c√πng l√∫c. T·ªëc ƒë·ªô cao.",
        file: "BKTL_LD.xlsm",
        updated: "29/12/2025 (v2.0)",
        icon: "üí∞", color: "linear-gradient(135deg, #10b981, #059669)", cssVar: "#10b981",
        guide: [
          "B∆∞·ªõc 1: Nh·∫≠p th√¥ng tin t·∫°i sheet \"<strong>THTT</strong>\"",
          "B∆∞·ªõc 2: T·∫£i LKGD & LKLS (Tool h·ªó tr·ª£ t·∫£i HTML si√™u t·ªëc).",
          "B∆∞·ªõc 3: Upload file v√†o ƒë√∫ng Sheet. <span style=\"color:#f43f5e\">H·ªó tr·ª£ ƒëa lu·ªìng file</span>.",
          "B∆∞·ªõc 4: B·∫•m <strong>ROBOT</strong> -> Nh·∫≠p pass: \"<span style=\"color:#f43f5e\">baotg10</span>\"",
          "B∆∞·ªõc 5: Ki·ªÉm tra k·∫øt qu·∫£ (G·ªëc, gi·∫£i ng√¢n k·ªπ thu·∫≠t...)."
        ]
      },
      {
        id: "the", code: "TH", name: "BKTL TH·∫∫ T√çN D·ª§NG", short: "Smart Card",
        subtitle: "B√≥c t√°ch l√£i th√¥ng minh, t·ªëi ∆∞u h√≥a quy tr√¨nh.",
        file: "BKTL_THE.xlsm",
        updated: "29/12/2025 (Fix bug)",
        icon: "üí≥", color: "linear-gradient(135deg, #ec4899, #db2777)", cssVar: "#ec4899",
        guide: [
          "B∆∞·ªõc 1: Sheet \"<strong>THTT</strong>\". Nh·∫≠p d∆∞ n·ª£ g·ªëc sao cho hi·ªán \"REF\".",
          "B∆∞·ªõc 2: Ng√†y sao k√™: V√†o Way4 t√¨m d√≤ng \"interest\", v√≠ d·ª• 26/01 -> nh·∫≠p <strong>26</strong>.",
          "B∆∞·ªõc 3: T·∫£i sao k√™ Way4 (Excel) -> Upload.",
          "B∆∞·ªõc 4: B·∫•m Robot -> Pass -> ·∫®n d√≤ng th·ª´a.",
          "B∆∞·ªõc 5: T√≠nh l√£i k·ª≥ hi·ªán t·∫°i theo c√¥ng th·ª©c hi·ªÉn th·ªã tr√™n file."
        ]
      },
      {
        id: "pd", code: "PD", name: "BKTL TH·∫§U CHI", short: "Coming Soon",
        subtitle: "ƒêang ph√°t tri·ªÉn - Phi√™n b·∫£n th·ª≠ nghi·ªám.",
        file: "#",
        updated: "D·ª± ki·∫øn 2026",
        icon: "üéØ", color: "linear-gradient(135deg, #f59e0b, #d97706)", cssVar: "#f59e0b",
        guide: [
          "üõ†Ô∏è T√≠nh nƒÉng ƒëang ƒë∆∞·ª£c ho√†n thi·ªán.",
          "Vui l√≤ng quay l·∫°i sau."
        ]
      }
    ];

    /* --- RENDERING --- */
    function renderList() {
      const listEl = document.getElementById('list');
      listEl.innerHTML = '';

      BANG_KE_LIST.forEach(item => {
        // T·∫°o th·∫ª bao
        const wrap = document.createElement('div');
        wrap.className = 'item';
        wrap.style.setProperty('--item-color', item.cssVar || '#3b82f6');
        wrap.style.setProperty('--bg-gradient-icon', item.color);

        // Header
        let html = `
          <div class="item-header" onclick="toggleItem(this)">
            <div class="icon-box">${item.icon}</div>
            <div class="info-box">
              <div class="info-title">
                ${item.name}
                <span class="info-chevron">‚ñº</span>
              </div>
              <div class="tags">
                <span class="tag">Excel Macro</span>
                <span class="tag">${item.short}</span>
                ${item.updated ? `<span class="tag update">Updated: ${item.updated}</span>` : ''}
              </div>
            </div>
          </div>
          
          <div class="extra">
            <div class="extra-desc">${item.subtitle}</div>
            
            <div class="action-grid">
              <a href="${item.file}" class="btn btn-primary" download>
                <span>‚¨á T·∫£i file ngay</span>
              </a>
              <button class="btn btn-secondary" onclick="toggleGuide(event, this)">
                <span>üìò Xem h∆∞·ªõng d·∫´n</span>
              </button>
            </div>

            <div class="inner-guide">
              <div style="font-weight:700; margin-bottom:10px; color:var(--text-main)">Chi ti·∫øt c√°c b∆∞·ªõc:</div>
              ${item.guide.map(line => `
                <div class="guide-line">
                  <span class="guide-bullet">‚óè</span>
                  <span>${line}</span>
                </div>
              `).join('')}
            </div>
          </div>
        `;
        
        wrap.innerHTML = html;
        listEl.appendChild(wrap);
      });
    }

    /* --- INTERACTIONS --- */
    function toggleItem(header) {
      const item = header.parentElement;
      const extra = item.querySelector('.extra');
      const isActive = item.classList.contains('active');

      // Close others
      document.querySelectorAll('.item').forEach(el => {
        el.classList.remove('active');
        el.querySelector('.extra').classList.remove('visible');
      });

      if (!isActive) {
        item.classList.add('active');
        extra.classList.add('visible');
      }
    }

    function toggleGuide(e, btn) {
      e.stopPropagation(); // Prevent item toggle
      const guideBox = btn.closest('.extra').querySelector('.inner-guide');
      const isVisible = guideBox.classList.contains('visible');
      
      if(isVisible){
        guideBox.classList.remove('visible');
        btn.innerHTML = '<span>üìò Xem h∆∞·ªõng d·∫´n</span>';
      } else {
        guideBox.classList.add('visible');
        btn.innerHTML = '<span>‚úï ƒê√≥ng h∆∞·ªõng d·∫´n</span>';
      }
    }

    /* --- ZOOM IMAGE --- */
    function zoomImg(el) {
      const img = el.querySelector('img');
      const overlay = document.getElementById('zoomOverlay');
      const target = document.getElementById('zoomTarget');
      target.src = img.src;
      overlay.classList.add('active');
    }
    function closeZoom() {
      document.getElementById('zoomOverlay').classList.remove('active');
    }

    /* --- THEME TOGGLE --- */
    function applyTheme(theme) {
      document.body.setAttribute('data-theme', theme);
      localStorage.setItem('bangke-theme', theme);
    }

    /* --- INITIALIZATION --- */
    document.addEventListener('DOMContentLoaded', () => {
      // Theme Check
      const savedTheme = localStorage.getItem('bangke-theme') || 'dark';
      applyTheme(savedTheme);

      // Render
      renderList();

      // Events
      document.getElementById('themeToggle').addEventListener('click', () => {
        const current = document.body.getAttribute('data-theme');
        applyTheme(current === 'dark' ? 'light' : 'dark');
      });

      // Setup Guide Accordion
      const guideHeader = document.querySelector('.setup-header');
      if(guideHeader) {
        guideHeader.addEventListener('click', function() {
          this.parentElement.classList.toggle('active');
        });
      }

      // Donate Modal
      const donateBtn = document.getElementById('donateBtn');
      const donateModal = document.getElementById('donateModal');
      const donateClose = document.getElementById('donateClose');

      donateBtn.addEventListener('click', () => donateModal.classList.add('visible'));
      donateClose.addEventListener('click', () => donateModal.classList.remove('visible'));
      donateModal.addEventListener('click', (e) => {
        if(e.target === donateModal) donateModal.classList.remove('visible');
      });
      
      // Escape key to close modals
      document.addEventListener('keydown', (e) => {
        if(e.key === 'Escape') {
          closeZoom();
          donateModal.classList.remove('visible');
        }
      });
    });
  </script>
</body>
</html>
