<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‚öôÔ∏è Admin B·∫£ng k√™</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont,
                   "Segoe UI", sans-serif;
    }
    body {
      min-height: 100vh;
      padding: 16px;
      background: #020617;
      color: #e5e7eb;
      display: flex;
      justify-content: center;
    }
    .shell {
      width: 100%;
      max-width: 1120px;
      display: grid;
      grid-template-columns: minmax(0, 1.3fr) minmax(0, 1fr);
      gap: 16px;
    }
    .panel {
      background: radial-gradient(circle at 0% 0%, rgba(148,163,184,0.20), transparent 60%),
                  #020617;
      border-radius: 18px;
      border: 1px solid #1f2937;
      padding: 14px 14px 12px;
      box-shadow: 0 18px 40px rgba(15,23,42,0.85);
    }
    .panel h1, .panel h2 {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    h1 {
      font-size: 18px;
      margin-bottom: 6px;
    }
    h2 {
      font-size: 14px;
      margin: 4px 0 4px;
    }
    .small {
      font-size: 12px;
      color: #9ca3af;
      margin-bottom: 6px;
    }
    .bk-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 4px;
      max-height: calc(100vh - 160px);
      overflow-y: auto;
      padding-right: 4px;
    }
    .bk {
      border-radius: 14px;
      border: 1px solid #1f2937;
      padding: 8px 10px 8px;
      background: #020617;
      box-shadow: 0 8px 24px rgba(15,23,42,0.7);
    }
    .bk-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 6px;
    }
    .bk-title {
      font-size: 13px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .bk-icon {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      background: radial-gradient(circle at 0% 0%, #22c55e, #3b82f6);
      box-shadow: 0 6px 14px rgba(59,130,246,0.7);
      flex-shrink: 0;
    }
    .bk-sub {
      font-size: 11px;
      color: #9ca3af;
    }
    .bk-actions {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .tag {
      font-size: 10px;
      padding: 2px 7px;
      border-radius: 999px;
      background: #0f172a;
      border: 1px solid #1f2937;
      color: #9ca3af;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .tag-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
    }
    .btn-small {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid #4b5563;
      background: #020617;
      color: #e5e7eb;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .btn-small span.icon {
      font-size: 13px;
    }
    label {
      display: block;
      font-size: 11px;
      color: #9ca3af;
      margin-bottom: 2px;
      margin-top: 4px;
    }
    input[type="text"],
    textarea {
      width: 100%;
      padding: 5px 7px;
      border-radius: 8px;
      border: 1px solid #1f2937;
      background: #020617;
      color: #e5e7eb;
      font-size: 12px;
    }
    input[type="text"]:focus,
    textarea:focus {
      outline: none;
      border-color: #60a5fa;
      box-shadow: 0 0 0 1px #60a5fa;
    }
    textarea {
      min-height: 70px;
      resize: vertical;
    }
    .row-2 {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 6px;
    }
    .file-row {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1fr);
      gap: 6px;
      align-items: center;
    }
    input[type="file"] {
      font-size: 11px;
      color: #9ca3af;
    }
    .file-hint {
      font-size: 10px;
      color: #6b7280;
      margin-top: 2px;
    }
    .btn-main {
      margin-top: 8px;
      padding: 7px 14px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #22c55e, #4ade80);
      color: #052e16;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 10px 26px rgba(16,185,129,0.75);
    }
    .btn-main span.icon {
      font-size: 15px;
    }
    #output {
      width: 100%;
      min-height: calc(100vh - 160px);
      background: #020617;
      border-radius: 10px;
      border: 1px solid #1f2937;
      padding: 8px 10px;
      color: #e5e7eb;
      font-size: 11px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      resize: none;
    }
    .hint {
      font-size: 11px;
      color: #9ca3af;
      margin-top: 4px;
    }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 10px;
      border-radius: 999px;
      font-size: 11px;
      border: 1px solid #1f2937;
      background: #020617;
      color: #9ca3af;
      margin-bottom: 6px;
    }
    .pill span.icon {
      font-size: 13px;
    }
    footer {
      position: fixed;
      bottom: 6px;
      left: 0;
      right: 0;
      text-align: center;
      font-size: 11px;
      color: #6b7280;
    }
    @media (max-width: 960px) {
      .shell {
        grid-template-columns: minmax(0, 1fr);
      }
      #output {
        min-height: 220px;
      }
      footer {
        position: static;
        margin-top: 8px;
      }
    }
  </style>
</head>
<body>
  <main class="shell">
    <!-- C·ªòT TR√ÅI: C·∫§U H√åNH -->
    <section class="panel">
      <h1><span>‚öôÔ∏è</span><span>Admin B·∫£ng k√™</span></h1>
      <div class="pill">
        <span class="icon">üìò</span>
        <span>M·ªói card = 1 b·∫£ng k√™ Excel (LD, Th·∫ª, ...)</span>
      </div>
      <p class="small">
        ƒêi·ªÅn th√¥ng tin t·ª´ng b·∫£ng k√™ b√™n d∆∞·ªõi. Sau ƒë√≥ COPY ƒëo·∫°n <b>BANG_KE_LIST</b> ·ªü c·ªôt ph·∫£i
        sang file <code>index.html</code> (d√°n ƒë√® ph·∫ßn c≈©).
      </p>

      <button class="btn-main" type="button" onclick="addBK()">
        <span class="icon">‚ûï</span>
        <span>Th√™m b·∫£ng k√™ m·ªõi</span>
      </button>

      <div class="bk-list" id="bkList"></div>
    </section>

    <!-- C·ªòT PH·∫¢I: CODE BANG_KE_LIST -->
    <section class="panel">
      <h2><span>üß©</span><span>ƒêo·∫°n m√£ JS BANG_KE_LIST</span></h2>
      <p class="small">
        B·∫•m v√†o √¥ b√™n d∆∞·ªõi, nh·∫•n <b>Ctrl + A</b> ‚Üí <b>Ctrl + C</b> ƒë·ªÉ copy to√†n b·ªô.<br>
        D√°n ƒë√® v√†o ph·∫ßn <code>const BANG_KE_LIST = [...]</code> trong file <b>index.html</b>.
      </p>
      <textarea id="output" readonly></textarea>
      <p class="hint">
        üí° G·ª£i √Ω: Trong √¥ H∆∞·ªõng d·∫´n b·∫°n c√≥ th·ªÉ d√πng HTML:
        <code>&lt;strong&gt;</code>, <code>&lt;a&gt;</code>, <code>&lt;img&gt;</code> ƒë·ªÉ in ƒë·∫≠m, ch√®n link, ch√®n h√¨nh.
      </p>
    </section>
  </main>

  <footer>¬© baotg10</footer>

  <script>
    // escape ƒë·ªÉ sinh JS an to√†n, v·∫´n gi·ªØ nguy√™n HTML (<, >)
    function esc(str) {
      return String(str)
        .replace(/\\/g, "\\\\")
        .replace(/"/g, "\\\"")
        .replace(/\r?\n/g, "\\n");
    }

    function addBK(data) {
      const list = document.getElementById('bkList');
      const d = data || {};

      const wrap = document.createElement('div');
      wrap.className = 'bk';

      const header = document.createElement('div');
      header.className = 'bk-header';

      const titleBox = document.createElement('div');
      const t1 = document.createElement('div');
      t1.className = 'bk-title';

      const tIcon = document.createElement('div');
      tIcon.className = 'bk-icon';
      tIcon.textContent = 'üìä';

      const tName = document.createElement('span');
      tName.textContent = d.name || 'B·∫£ng k√™ m·ªõi';

      t1.appendChild(tIcon);
      t1.appendChild(tName);

      const t2 = document.createElement('div');
      t2.className = 'bk-sub';
      t2.textContent = d.id ? ('ID: ' + d.id) : 'Ch∆∞a c√≥ ID';

      titleBox.appendChild(t1);
      titleBox.appendChild(t2);

      const actions = document.createElement('div');
      actions.className = 'bk-actions';

      const tag = document.createElement('div');
      tag.className = 'tag';
      tag.innerHTML = '<span class="tag-dot"></span><span>Excel / xlsm</span>';

      const btnDel = document.createElement('button');
      btnDel.type = 'button';
      btnDel.className = 'btn-small';
      btnDel.innerHTML = '<span class="icon">üóëÔ∏è</span><span>X√≥a</span>';
      btnDel.onclick = function () {
        wrap.remove();
        generate();
      };

      actions.appendChild(tag);
      actions.appendChild(btnDel);

      header.appendChild(titleBox);
      header.appendChild(actions);
      wrap.appendChild(header);

      // H√†ng ID + CODE
      const rowIds = document.createElement('div');
      rowIds.className = 'row-2';
      rowIds.innerHTML = `
        <div>
          <label>ID (kh√¥ng d·∫•u, kh√¥ng kho·∫£ng tr·∫Øng)</label>
          <input type="text" class="f-id" value="${d.id || ''}" />
        </div>
        <div>
          <label>Code hi·ªÉn th·ªã (v√≠ d·ª•: LD, TH)</label>
          <input type="text" class="f-code" value="${d.code || ''}" />
        </div>
      `;
      wrap.appendChild(rowIds);

      // T√™n + m√¥ t·∫£
      const rowNames = document.createElement('div');
      rowNames.innerHTML = `
        <label>üìù T√™n hi·ªÉn th·ªã (v√≠ d·ª•: B·∫£ng k√™ LD)</label>
        <input type="text" class="f-name" value="${d.name || ''}" />
        <label>üè∑Ô∏è M√¥ t·∫£ ng·∫Øn (chip b√™n c·∫°nh, v√≠ d·ª•: M·∫´u Excel LD)</label>
        <input type="text" class="f-short" value="${d.short || ''}" />
        <label>üìÑ M√¥ t·∫£ chi ti·∫øt (hi·ªán khi bung n·ªôi dung)</label>
        <input type="text" class="f-subtitle" value="${d.subtitle || ''}" />
      `;
      wrap.appendChild(rowNames);

      // File + ng√†y c·∫≠p nh·∫≠t
      const fileRow = document.createElement('div');
      fileRow.className = 'file-row';
      fileRow.innerHTML = `
        <div>
          <label>üìÇ T√™n file Excel tr√™n hosting (v√≠ d·ª•: Bang_ke_LD.xlsm)</label>
          <input type="text" class="f-file" value="${d.file || ''}" />
          <div class="file-hint">T√™n n√†y ph·∫£i tr√πng v·ªõi file b·∫°n upload l√™n c√πng th∆∞ m·ª•c v·ªõi index.html</div>
        </div>
        <div>
          <label>üìÖ Ng√†y c·∫≠p nh·∫≠t (hi·ªÉn tr√™n t·ª´ng b·∫£ng k√™)</label>
          <input type="text" class="f-updated" placeholder="dd/mm/yyyy" value="${d.updated || ''}" />
        </div>
      `;

      // input file ch·ªâ ƒë·ªÉ l·∫•y t√™n, kh√¥ng upload
      const fileInput = document.createElement('input');
      fileInput.type = 'file';
      fileInput.accept = '.xlsx,.xlsm,.xls';
      fileInput.onchange = function () {
        if (fileInput.files[0]) {
          fileRow.querySelector('.f-file').value = fileInput.files[0].name;
          generate();
        }
      };
      const fileInputWrap = document.createElement('div');
      fileInputWrap.style.marginTop = '4px';
      fileInputWrap.appendChild(fileInput);
      fileRow.appendChild(fileInputWrap);

      wrap.appendChild(fileRow);

      // H∆∞·ªõng d·∫´n
      const guideBox = document.createElement('div');
      guideBox.innerHTML = `
        <label>üìò H∆∞·ªõng d·∫´n  
          <span style="font-weight:400;color:#6b7280;">(m·ªói d√≤ng = 1 b∆∞·ªõc, c√≥ th·ªÉ d√πng HTML: &lt;strong&gt;, &lt;a&gt;, &lt;img&gt;)</span>
        </label>
        <textarea class="f-guide">${d.guide ? d.guide.join('\n') : ''}</textarea>
      `;
      wrap.appendChild(guideBox);

      list.appendChild(wrap);

      // c·∫≠p nh·∫≠t ti√™u ƒë·ªÅ + sinh code khi nh·∫≠p
      wrap.querySelectorAll('input,textarea').forEach(el => {
        el.addEventListener('input', () => {
          const nameVal = wrap.querySelector('.f-name').value.trim();
          tName.textContent = nameVal || 'B·∫£ng k√™ m·ªõi';
          const idVal = wrap.querySelector('.f-id').value.trim();
          t2.textContent = idVal ? ('ID: ' + idVal) : 'Ch∆∞a c√≥ ID';
          generate();
        });
      });

      generate();
    }

    function collect() {
      const items = [];
      document.querySelectorAll('.bk').forEach(wrap => {
        const id = wrap.querySelector('.f-id').value.trim();
        if (!id) return;
        const code = wrap.querySelector('.f-code').value.trim();
        const name = wrap.querySelector('.f-name').value.trim();
        const short = wrap.querySelector('.f-short').value.trim();
        const subtitle = wrap.querySelector('.f-subtitle').value.trim();
        const file = wrap.querySelector('.f-file').value.trim();
        const updated = wrap.querySelector('.f-updated').value.trim();
        const guideRaw = wrap.querySelector('.f-guide').value;
        const guide = guideRaw
          .split(/\r?\n/)
          .map(s => s.trim())
          .filter(Boolean);
        items.push({ id, code, name, short, subtitle, file, updated, guide });
      });
      return items;
    }

    function generate() {
      const items = collect();
      let out = 'const BANG_KE_LIST = [\n';
      items.forEach((it, idx) => {
        out += '  {\n';
        out += '    id: "' + esc(it.id) + '",\n';
        out += '    code: "' + esc(it.code) + '",\n';
        out += '    name: "' + esc(it.name) + '",\n';
        out += '    short: "' + esc(it.short) + '",\n';
        out += '    subtitle: "' + esc(it.subtitle) + '",\n';
        out += '    file: "' + esc(it.file) + '",\n';
        out += '    updated: "' + esc(it.updated) + '",\n';
        out += '    guide: [\n';
        it.guide.forEach((g, i2) => {
          out += '      "' + esc(g) + '"';
          out += i2 < it.guide.length - 1 ? ',\n' : '\n';
        });
        out += '    ]\n';
        out += idx < items.length - 1 ? '  },\n' : '  }\n';
      });
      out += '];\n';
      document.getElementById('output').value = out;
    }

    function seedDefault() {
      // M·∫∑c ƒë·ªãnh s·∫µn 2 b·∫£ng k√™: LD v√† Th·∫ª
      addBK({
        id: 'ld',
        code: 'LD',
        name: 'B·∫£ng k√™ LD',
        short: 'M·∫´u Excel LD',
        subtitle: 'File Excel theo d√µi v√† t√≠nh l√£i d·∫°ng LD',
        file: 'Bang_ke_LD.xlsm',
        updated: '10/11/2025',
        guide: [
          'Nh·∫≠p k·ª≥ (th√°ng/qu√Ω/nƒÉm) v√† c√°c th√¥ng tin LD ·ªü t·ª´ng d√≤ng.',
          'ƒêi·ªÅn s·ªë ti·ªÅn g·ªëc, l√£i su·∫•t, s·ªë ng√†y/k·ª≥ theo m·∫´u trong file.',
          '<strong>Kh√¥ng s·ª≠a tr·ª±c ti·∫øp</strong> c√°c √¥ t·ªïng, l√£i, s·ªë d∆∞ ƒë√£ c√≥ c√¥ng th·ª©c.',
          'N·∫øu c·∫ßn ƒë·ªïi c√°ch t√≠nh, ch·ªânh c√¥ng th·ª©c ·ªü h√†ng m·∫´u r·ªìi sao ch√©p xu·ªëng.',
          'N√™n l∆∞u 1 b·∫£n g·ªëc, l√†m vi·ªác tr√™n b·∫£n sao ƒë·ªÉ tr√°nh m·∫•t c·∫•u tr√∫c ban ƒë·∫ßu.'
        ]
      });
      addBK({
        id: 'the',
        code: 'TH',
        name: 'B·∫£ng k√™ Th·∫ª',
        short: 'M·∫´u Excel Th·∫ª',
        subtitle: 'File Excel theo d√µi giao d·ªãch v√† l√£i theo th·∫ª',
        file: 'Bang_ke_The.xlsm',
        updated: '10/11/2025',
        guide: [
          'Nh·∫≠p k·ª≥ sao k√™, s·ªë d∆∞ ƒë·∫ßu k·ª≥ v√† h·∫°n m·ª©c th·∫ª (n·∫øu c√≥).',
          'Ghi c√°c giao d·ªãch ph√°t sinh ƒë√∫ng c·ªôt: chi ti√™u, ho√†n ti·ªÅn, ph√≠, v.v.',
          'C√°c c·ªôt t√≠nh l√£i, ph√≠ ph·∫°t v√† s·ªë d∆∞ cu·ªëi k·ª≥ ƒë√£ c√≥ s·∫µn c√¥ng th·ª©c.',
          'C√≥ th·ªÉ t√°ch m·ªói th·∫ª th√†nh m·ªôt sheet ri√™ng ƒë·ªÉ qu·∫£n l√Ω cho r√µ r√†ng.',
          'N√™n l∆∞u 1 b·∫£n g·ªëc, thao t√°c tr√™n b·∫£n sao ƒë·ªÉ tr√°nh h·ªèng c√¥ng th·ª©c.'
        ]
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      seedDefault();
    });
  </script>
</body>
</html>
